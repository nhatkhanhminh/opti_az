# AZC Staking Contract

## M√¥ t·∫£
Contract AZCStaking ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·∫∑c bi·ªát cho vi·ªác staking AZC token v·ªõi gi√° c·ªë ƒë·ªãnh c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh b·ªüi owner. ƒê√¢y l√† contract ƒë·ªôc l·∫≠p d√†nh ri√™ng cho AZC token, kh√°c v·ªõi contract staking ch√≠nh h·ªó tr·ª£ nhi·ªÅu lo·∫°i token.

## T√≠nh nƒÉng ch√≠nh

### üéØ Core Features
- **Staking AZC Token**: Ch·ªâ h·ªó tr·ª£ staking AZC token
- **Gi√° c·ªë ƒë·ªãnh**: Gi√° AZC ƒë∆∞·ª£c set th·ªß c√¥ng, m·∫∑c ƒë·ªãnh 1.5 USDT
- **5 Staking Plans**: T·ª´ $99 ƒë·∫øn $50,000+ v·ªõi ROI kh√°c nhau
- **Fee Distribution**: Ph√¢n ph·ªëi fee cho c√°c wallet v√† referral system
- **Leader Share**: H·ªó tr·ª£ ph√¢n ph·ªëi leader fee theo branch

### üí∞ Staking Plans
**Kh√¥ng c√≥ plans m·∫∑c ƒë·ªãnh** - Admin s·∫Ω t·∫°o plans sau khi deploy contract.

**V√≠ d·ª• plans th∆∞·ªùng d√πng:**
| Plan | Minimum | Maximum | Monthly ROI |
|------|---------|---------|-------------|
| 0    | $99     | ‚àû       | 10%         |
| 1    | $99     | ‚àû       | 12%         |
| 2    | $99     | ‚àû       | 16%         |

**Ghi ch√∫**: 
- Minimum amount v√† % l√£i c√≥ th·ªÉ ƒë∆∞·ª£c admin ƒëi·ªÅu ch·ªânh b·∫•t k·ª≥ l√∫c n√†o
- Maximum amount m·∫∑c ƒë·ªãnh l√† kh√¥ng gi·ªõi h·∫°n
- Admin c√≥ th·ªÉ t·∫°o bao nhi√™u plans t√πy √Ω

### üí∏ Fee Structure (%)
- **Dev Fee**: 2%
- **Marketing Fee**: 15%
- **Multi Wallet Fee**: 37%
- **Leader Fee**: 33%
- **Referral L1**: 6%
- **Referral L2**: 1%
- **Referral L3**: 1%

## Deployment

### 1. Chu·∫©n b·ªã
```bash
# C√†i ƒë·∫∑t dependencies
npm install

# Copy file v√† c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ AZC token
cp contract/deploy_azc_staking.js .
```

### 2. C·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ AZC Token
S·ª≠a file `deploy_azc_staking.js`:
```javascript
const AZC_TOKEN_ADDRESS = "0xYOUR_AZC_TOKEN_ADDRESS_HERE";
```

### 3. Deploy Contract
```bash
# Deploy tr√™n BSC Testnet
npx hardhat run deploy_azc_staking.js --network bsc-testnet

# Deploy tr√™n BSC Mainnet
npx hardhat run deploy_azc_staking.js --network bsc
```

### 4. Verify Contract
```bash
npx hardhat verify --network bsc CONTRACT_ADDRESS AZC_TOKEN_ADDRESS
```

## S·ª≠ d·ª•ng Contract

### Staking AZC
```solidity
// Approve AZC token tr∆∞·ªõc
IERC20(AZC_TOKEN).approve(AZC_STAKING_CONTRACT, amount);

// Stake v·ªõi plan ID
AZCStaking.stakeAZC(amount, planId);
```

### Set gi√° AZC (Owner only)
```solidity
// Set gi√° 2.0 USDT
uint256 newPrice = 2 * 10**18; // 2.0 USDT
azcStaking.setAZCPrice(newPrice);
```

### L·∫•y gi√° AZC hi·ªán t·∫°i
```solidity
uint256 currentPrice = azcStaking.getAZCPrice();
// Result: 1500000000000000000 (1.5 USDT)
```

### T√≠nh gi√° tr·ªã USDT c·ªßa AZC
```solidity
uint256 azcAmount = 100 * 10**18; // 100 AZC
uint256 usdtValue = azcStaking.getAZCToUSDTValue(azcAmount);
// Result: 150 * 10**18 (150 USDT n·∫øu gi√° 1.5 USDT/AZC)
```

## Admin Functions

### Qu·∫£n l√Ω Staking Plans
```solidity
// T·∫°o plan m·ªõi ƒë∆°n l·∫ª
azcStaking.createStakingPlan(
    100 * 10**18,   // Min: $100
    type(uint256).max, // Max: Kh√¥ng gi·ªõi h·∫°n
    120             // ROI: 12% monthly
);

// T·∫°o nhi·ªÅu plans c√πng l√∫c
uint256[] memory minAmounts = [99*10**18, 99*10**18, 99*10**18];
uint256[] memory maxAmounts = [type(uint256).max, type(uint256).max, type(uint256).max];
uint256[] memory monthlyROIs = [100, 120, 160]; // 10%, 12%, 16%
azcStaking.createMultipleStakingPlans(minAmounts, maxAmounts, monthlyROIs);

// C·∫≠p nh·∫≠t plan ho√†n ch·ªânh
azcStaking.updateStakingPlan(0, 99 * 10**18, type(uint256).max, 100, true);

// C·∫≠p nh·∫≠t ch·ªâ % l√£i c·ªßa plan
azcStaking.updatePlanROI(0, 150); // ƒê·ªïi plan 0 th√†nh 15%

// C·∫≠p nh·∫≠t ch·ªâ min amount c·ªßa plan
azcStaking.updatePlanMinAmount(0, 50 * 10**18); // Set min $50 cho plan 0

// C·∫≠p nh·∫≠t minimum amount cho t·∫•t c·∫£ plans c√πng l√∫c
azcStaking.updateAllPlansMinAmount(50 * 10**18); // Set min $50 cho t·∫•t c·∫£

// K√≠ch ho·∫°t/v√¥ hi·ªáu h√≥a plan
azcStaking.toggleStakingPlan(1, false); // T·∫Øt plan 1
azcStaking.toggleStakingPlan(1, true);  // B·∫≠t plan 1
```

### View Functions
```solidity
// Xem t·∫•t c·∫£ staking plans
StakingPlan[] memory plans = azcStaking.getAllStakingPlans();

// ƒê·∫øm s·ªë l∆∞·ª£ng plans
uint256 count = azcStaking.getStakingPlansCount();

// Ki·ªÉm tra plan c√≥ active kh√¥ng
bool isActive = azcStaking.isPlanActive(0);
```

### C·∫≠p nh·∫≠t Fees
```solidity
azcStaking.updateFeePercentages(
    2,  // dev
    15, // marketing
    37, // multiWallet
    33, // leader
    6,  // referral L1
    1,  // referral L2
    1   // referral L3
);
```

### C·∫≠p nh·∫≠t Wallets
```solidity
azcStaking.setWallets(
    devWallet,
    marketingWallet,
    multiWallet,
    poolWallet
);
```

### C·∫≠p nh·∫≠t Contract Addresses
```solidity
azcStaking.setMemberContract(newMemberContract);
azcStaking.setDataContract(newDataContract);
azcStaking.setLeaderShareContract(newLeaderShareContract);
```

## Events

### Staking Events
```solidity
event AZCStaked(
    address indexed user,
    uint256 amount,
    uint256 usdtValue,
    uint256 planId
);

event AZCPriceUpdated(
    uint256 oldPrice,
    uint256 newPrice
);
```

### Admin Events
```solidity
event StakingPlanCreated(
    uint256 indexed planId,
    uint256 minAmount,
    uint256 maxAmount,
    uint256 monthlyROI
);

event StakingPlanUpdated(
    uint256 indexed planId,
    uint256 minAmount,
    uint256 maxAmount,
    uint256 monthlyROI,
    bool active
);
```

## Integration v·ªõi Frontend

### 1. C·∫≠p nh·∫≠t Context
Th√™m v√†o `Context/listaddress.ts`:
```typescript
export const AZC_STAKING = "0xYOUR_AZC_STAKING_CONTRACT_ADDRESS";
export const AZC_TOKEN = "0xYOUR_AZC_TOKEN_ADDRESS";
```

### 2. C·∫≠p nh·∫≠t Token Context
S·ª≠a `Context/token.ts`:
```typescript
{
  id: "azc",
  name: "AZ Coin",
  symbol: "AZC",
  icon: "/images/tokens/azc.svg",
  tokenAddress: AZC_TOKEN,
  comingSoon: false, // B·ªè comingSoon
}
```

### 3. Contract Hook
T·∫°o hook m·ªõi:
```typescript
// hooks/useAZCStaking.ts
export const useAZCStakingContract = () => {
  return getContract({
    client,
    chain: bsc,
    address: AZC_STAKING,
  });
};
```

### 4. C·∫≠p nh·∫≠t Staking Page
S·ª≠a `app/[locale]/staking/page.tsx` ƒë·ªÉ support AZC:
```typescript
// Th√™m logic cho AZC staking
const isAZC = useMemo(() => token?.symbol === "AZC", [token]);

if (isAZC) {
  // S·ª≠ d·ª•ng AZC staking contract thay v√¨ contract ch√≠nh
  const azcStakingContract = useAZCStakingContract();
  
  // Get AZC staking plans ri√™ng
  const getAZCStakingPlans = async () => {
    return await azcStakingContract.getAllStakingPlans();
  };
  
  // Check AZC price
  const getAZCPrice = async () => {
    return await azcStakingContract.getAZCPrice();
  };
  
  // Stake AZC
  const stakeAZC = prepareContractCall({
    contract: azcStakingContract,
    method: "function stakeAZC(uint256 amount, uint256 planId)",
    params: [amountInWei, BigInt(planIndex)],
  });
}
```

## V√≠ d·ª• S·ª≠ d·ª•ng

### Script Helper ƒë·ªÉ set gi√°
```javascript
const { setAZCPrice } = require('./deploy_azc_staking');

// Set gi√° AZC th√†nh 2.5 USDT
await setAZCPrice("0xCONTRACT_ADDRESS", 2.5);
```

### Script Helper ƒë·ªÉ qu·∫£n l√Ω plans
```javascript
const { 
  setupDefaultPlans,      // T·∫°o nhanh 3 plans: 10%, 12%, 16%
  createStakingPlan,      // T·∫°o plan ƒë∆°n l·∫ª
  createMultipleStakingPlans, // T·∫°o nhi·ªÅu plans c√πng l√∫c
  updatePlanROI,          // C·∫≠p nh·∫≠t % l√£i ri√™ng l·∫ª
  updatePlanMinAmount,    // C·∫≠p nh·∫≠t min amount ri√™ng l·∫ª
  updateAllPlansMinAmount, // C·∫≠p nh·∫≠t min amount t·∫•t c·∫£
  toggleStakingPlan,      // B·∫≠t/t·∫Øt plan
  viewAllPlans            // Xem t·∫•t c·∫£ plans
} = require('./deploy_azc_staking');

// C√ÅCH 1: Setup nhanh 3 plans m·∫∑c ƒë·ªãnh (KHUY·∫æN NGH·ªä)
await setupDefaultPlans("0xCONTRACT_ADDRESS", 99); // 3 plans v·ªõi min $99

// C√ÅCH 2: T·∫°o plans th·ªß c√¥ng
// T·∫°o plan ƒë∆°n l·∫ª
await createStakingPlan("0xCONTRACT_ADDRESS", 50, Infinity, 8.0);

// T·∫°o nhi·ªÅu plans c√πng l√∫c
const plansData = [
  { minAmount: 100, maxAmount: Infinity, monthlyROI: 15 },
  { minAmount: 500, maxAmount: Infinity, monthlyROI: 18 },
  { minAmount: 1000, maxAmount: Infinity, monthlyROI: 20 }
];
await createMultipleStakingPlans("0xCONTRACT_ADDRESS", plansData);

// QU·∫¢N L√ù PLANS
// C·∫≠p nh·∫≠t ch·ªâ % l√£i
await updatePlanROI("0xCONTRACT_ADDRESS", 0, 12); // Plan 0 -> 12%

// C·∫≠p nh·∫≠t ch·ªâ min amount m·ªôt plan
await updatePlanMinAmount("0xCONTRACT_ADDRESS", 1, 200); // Plan 1 -> $200

// C·∫≠p nh·∫≠t min amount t·∫•t c·∫£ plans
await updateAllPlansMinAmount("0xCONTRACT_ADDRESS", 50); // T·∫•t c·∫£ -> $50

// T·∫Øt/b·∫≠t plan
await toggleStakingPlan("0xCONTRACT_ADDRESS", 2, false); // T·∫Øt plan 2

// Xem t·∫•t c·∫£ plans
await viewAllPlans("0xCONTRACT_ADDRESS");
```

### Workflow t·ª´ A-Z:
```bash
# 1. Deploy contract (ch∆∞a c√≥ plans n√†o)
npx hardhat run deploy_azc_staking.js --network bsc

# 2. Set gi√° AZC n·∫øu kh√°c 1.5 USDT
node -e "
const { setAZCPrice } = require('./deploy_azc_staking');
setAZCPrice('CONTRACT_ADDRESS', 2.0);
"

# 3. T·∫†O PLANS (ch·ªçn 1 trong 2 c√°ch):

# C√ÅCH A: Setup nhanh 3 plans (10%, 12%, 16%) - KHUY·∫æN NGH·ªä
node -e "
const { setupDefaultPlans } = require('./deploy_azc_staking');
setupDefaultPlans('CONTRACT_ADDRESS', 99);
"

# C√ÅCH B: T·∫°o plans t√πy ch·ªânh
node -e "
const { createStakingPlan } = require('./deploy_azc_staking');
createStakingPlan('CONTRACT_ADDRESS', 50, Infinity, 8.0);
createStakingPlan('CONTRACT_ADDRESS', 100, Infinity, 15.0);
"

# 4. Xem v√† qu·∫£n l√Ω plans
node -e "
const { viewAllPlans, updatePlanROI } = require('./deploy_azc_staking');
viewAllPlans('CONTRACT_ADDRESS');
updatePlanROI('CONTRACT_ADDRESS', 0, 11); // ƒê·ªïi plan 0 th√†nh 11%
"

# 5. D√πng Admin Panel cho vi·ªác qu·∫£n l√Ω d·ªÖ d√†ng h∆°n
# (C·∫≠p nh·∫≠t CONTRACT_ADDRESS trong azc_staking_admin.js tr∆∞·ªõc)
node azc_staking_admin.js
```

### Admin Panel Interface:
```bash
üöÄ AZC Staking Admin Panel
üìç Contract: 0x...
üëë Owner: 0x...
ü™ô AZC Token: 0x...
üíµ AZC Price: 1.5 USDT

==================================================
üìã MENU ADMIN:
1. üëÄ Xem t·∫•t c·∫£ Staking Plans
2. üí∞ Set gi√° AZC
3. üìä T·∫°o Staking Plan m·ªõi
4. ‚úèÔ∏è  C·∫≠p nh·∫≠t Staking Plan ho√†n ch·ªânh
5. üîÑ Toggle Plan Active/Inactive
6. üìà C·∫≠p nh·∫≠t % l√£i (ROI) c·ªßa Plan
7. üíµ C·∫≠p nh·∫≠t Min Amount c·ªßa Plan
8. üíµ C·∫≠p nh·∫≠t Min Amount cho t·∫•t c·∫£ Plans
9. ‚ö° Setup Plans m·∫∑c ƒë·ªãnh nhanh (10%, 12%, 16%)
10. üè¶ C·∫≠p nh·∫≠t Wallet Addresses
11. üí∏ C·∫≠p nh·∫≠t Fee Percentages
12. üÜò Emergency Withdraw
0. üö™ Tho√°t
==================================================
```

## Security Features

### ‚úÖ Implemented
- **ReentrancyGuard**: Ch·ªëng t·∫•n c√¥ng reentrancy
- **Ownable**: Ki·ªÉm so√°t quy·ªÅn admin
- **Input Validation**: Validate t·∫•t c·∫£ input parameters
- **Emergency Withdraw**: R√∫t token trong tr∆∞·ªùng h·ª£p kh·∫©n c·∫•p

### ‚ö†Ô∏è Recommendations
- Th·ª±c hi·ªán audit code tr∆∞·ªõc khi deploy mainnet
- Test k·ªπ tr√™n testnet
- Setup multisig wallet cho owner
- Monitor contract activities

## L∆∞u √Ω quan tr·ªçng

1. **Gi√° AZC**: C·∫ßn ƒë∆∞·ª£c c·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n v√¨ kh√¥ng c√≥ oracle
2. **Dependency**: Contract ph·ª• thu·ªôc v√†o Member, Data v√† LeaderShare contracts
3. **Permissions**: Ch·ªâ owner m·ªõi c√≥ th·ªÉ thay ƒë·ªïi gi√° v√† c·∫•u h√¨nh
4. **Gas Optimization**: Contract ƒë√£ ƒë∆∞·ª£c t·ªëi ∆∞u gas cho c√°c thao t√°c th∆∞·ªùng xuy√™n

## Support & Troubleshooting

### Common Issues
1. **"Plan does not exist"**: Ki·ªÉm tra planId c√≥ h·ª£p l·ªá
2. **"Amount below plan minimum"**: TƒÉng amount ho·∫∑c ch·ªçn plan kh√°c
3. **"Token not approved"**: Approve AZC token tr∆∞·ªõc khi stake

### Contact
- GitHub Issues: [Repository URL]
- Documentation: [Docs URL] 